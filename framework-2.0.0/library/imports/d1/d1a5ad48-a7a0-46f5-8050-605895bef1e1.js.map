{"version":3,"sources":["assets\\script\\Framework\\Process\\GameNotification\\AutoStateChangeNotification.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AACA,sEAA4D;AAC5D,yDAAoD;AAGpD;;;;;GAKG;AACH;IAMI;QACI,IAAI,CAAC,QAAQ,GAAG,IAAI,GAAG,EAA2B,CAAC;IACvD,CAAC;IAMD,sBAAkB,uCAAQ;QAJ1B;;;WAGG;aACH;YACI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;gBACjB,IAAI,CAAC,SAAS,GAAG,IAAI,2BAA2B,EAAE,CAAC;aACtD;YACD,OAAO,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAED;;;;OAIG;IACH,+CAAS,GAAT,UAAU,QAAiC,EAAE,WAAoB;QAC7D,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC7B,sBAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,4BAAS,CAAC,OAAO,EAAK,QAAQ,mHAAsB,CAAC,CAAA;YACxF,OAAO;SACV;QACD,QAAQ,CAAC,WAAW,GAAG,WAAW,CAAC;QACnC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAChC,CAAC;IAED,iDAAW,GAAX,UAAY,QAAiC;QACzC,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC7B,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;SAClC;aAAM;YACH,sBAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,4BAAS,CAAC,aAAa,EAAK,QAAQ,+GAAuB,CAAC,CAAC;SACnG;IACL,CAAC;IAED;;;;;OAKG;IACH,4CAAM,GAAN,UAAO,gBAAyB,EAAE,eAAyB,EAAE,cAAwB;;QACjF,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,EAAE;;gBACxB,KAAqB,IAAA,KAAA,SAAA,IAAI,CAAC,QAAQ,CAAA,gBAAA,4BAAE;oBAA/B,IAAI,QAAQ,WAAA;oBACb,QAAQ,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC,CAAC;oBAC7E,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;wBACvB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;qBAC9B;iBACJ;;;;;;;;;SACJ;IACL,CAAC;IAED,uDAAiB,GAAjB;QACI,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;IAC9B,CAAC;IAED,qDAAe,GAAf;QACI,OAAO,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC;IAGL,kCAAC;AAAD,CArEA,AAqEC,IAAA","file":"","sourceRoot":"/","sourcesContent":["import {AutoType} from \"../../Config/Enum/ConfigEnum\";\r\nimport {ErrorType} from \"../../Error/Enum/ErrorManagerEnum\";\r\nimport ErrorManager from \"../../Error/ErrorManager\";\r\nimport AutoStateChangeObserver from \"../GameObserver/AutoStateChangeObserver\";\r\n\r\n/**\r\n * @Author XIAO-LI-PIN\r\n * @Description 通知管理器 : 自動狀態改變時事件推播管理器\r\n * @Date 2021-05-20 下午 05:05\r\n * @Version 1.0\r\n */\r\nexport default class AutoStateChangeNotification implements INotificationManager {\r\n\r\n    private readonly observer: Set<AutoStateChangeObserver>;\r\n\r\n    private static _instance: AutoStateChangeNotification;\r\n\r\n    private constructor() {\r\n        this.observer = new Set<AutoStateChangeObserver>();\r\n    }\r\n\r\n    /**\r\n     * 懶漢加載,單例模式\r\n     * @returns {AutoStateChangeNotification}\r\n     */\r\n    public static get instance(): AutoStateChangeNotification {\r\n        if (!this._instance) {\r\n            this._instance = new AutoStateChangeNotification();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    /**\r\n     * 訂閱該事件\r\n     * @param {AutoStateChangeObserver} observer : 關注者\r\n     * @param {boolean} isPermanent : 是否常駐\r\n     */\r\n    subscribe(observer: AutoStateChangeObserver, isPermanent: boolean) {\r\n        if (this.observer.has(observer)) {\r\n            ErrorManager.instance.executeError(ErrorType.SceneFW, `${observer} 該類已註冊過自動狀態改變時事件,請檢查`)\r\n            return;\r\n        }\r\n        observer.isPermanent = isPermanent;\r\n        this.observer.add(observer);\r\n    }\r\n\r\n    unsubscribe(observer: AutoStateChangeObserver) {\r\n        if (this.observer.has(observer)) {\r\n            this.observer.delete(observer);\r\n        } else {\r\n            ErrorManager.instance.executeError(ErrorType.GameProcessFW, `${observer} : 該觀察類尚未綁定過,無須移除觀察對象`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 發送自動狀態通知\r\n     * @param {boolean} isAutomaticState - 更改後的狀態是否是自動狀態\r\n     * @param {AutoType} beforeAutoCount - 更改前的auto類型\r\n     * @param {AutoType} afterAutoCount  - 更改後的auto類型\r\n     */\r\n    notify(isAutomaticState: boolean, beforeAutoCount: AutoType, afterAutoCount: AutoType) {\r\n        if (this.observer.size > 0) {\r\n            for (let observer of this.observer) {\r\n                observer.pushNotification(isAutomaticState, beforeAutoCount, afterAutoCount);\r\n                if (!observer.isPermanent) {\r\n                    this.unsubscribe(observer);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getSubscribeCount(): number {\r\n        return this.observer.size;\r\n    }\r\n\r\n    getAllSubscribe(): Set<AutoStateChangeObserver> {\r\n        return this.observer;\r\n    }\r\n\r\n\r\n}"]}