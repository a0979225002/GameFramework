{"version":3,"sources":["assets\\script\\Framework\\Template\\Slot\\ASlotInitializeTemplate.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import {ErrorType} from \"../../Error/Enum/ErrorManagerEnum\";\r\nimport ErrorManager from \"../../Error/ErrorManager\";\r\nimport {ServerEventType} from \"../../Listener/Enum/ServerEventType\";\r\nimport EventManager from \"../../Listener/EventManager\";\r\nimport SlotGameManager from \"../../Process/SlotGameManager\";\r\nimport {ResponseType} from \"../../WebResponse/Enum/ResponseType\";\r\nimport {WebResponseManager} from \"../../WebResponse/WebResponseManager\";\r\nimport OverrideComponent from \"../OverrideComponent\";\r\n\r\nconst {ccclass} = cc._decorator;\r\n\r\n@ccclass\r\nexport default abstract class ASlotInitializeTemplate extends OverrideComponent {\r\n\r\n    //slot 的列\r\n    protected abstract slotRow: Array<cc.Node>;\r\n    protected abstract gridNodeToMap: Map<number, Array<cc.Node>>;\r\n    protected abstract girdSpriteToMap: Map<number, Array<cc.Sprite>>;\r\n    protected normalResult: ISlotResultModel;\r\n    protected freeResult: ISlotFreeResultModel;\r\n\r\n    protected abstract onCreate();\r\n\r\n    /**\r\n     * SlotStyle 初設定,如無符合的功能樣式 可繼承抽象類 ASlot 自定義使用\r\n     */\r\n    protected abstract slotStyleSetting();\r\n\r\n    /**\r\n     * 更新所有grid 隨機圖片\r\n     * 如果每列的3~5格格子需要顯示 TableInfo 回傳回來的初始grid答案\r\n     * @private\r\n     */\r\n    protected abstract slotInitialize();\r\n\r\n    protected abstract getAllGridNode(): Map<number, Array<cc.Node>>;\r\n\r\n    protected abstract getAllGridSprite(): Map<number, Array<cc.Sprite>>;\r\n\r\n    protected onLoad() {\r\n        this.normalResult =\r\n            WebResponseManager\r\n                .instance<ISlotResultModel>()\r\n                .getResult(ResponseType.NORMAL);\r\n\r\n        this.freeResult =\r\n            WebResponseManager\r\n                .instance<ISlotFreeResultModel>()\r\n                .getResult(ResponseType.FREE);\r\n        this.onCreate();\r\n        this.slotInitialize();\r\n        this.slotStyleSetting();\r\n        this.normalResultResponse();\r\n        this.freeResultEvenResponse();\r\n    }\r\n\r\n\r\n    /**\r\n     * 一般狀態回傳事件接收器\r\n     */\r\n    private normalResultResponse(): void {\r\n\r\n        EventManager.instance.serverEventListener(ServerEventType.BET_RESULT, (target: object) => {\r\n            for (let name of Object.keys(target)) {\r\n                if (this.normalResult[name] === undefined) {\r\n                    try {\r\n                        ErrorManager.instance.executeError(ErrorType.WebResponseErrorFW, `${name}參數未宣告:無法保存回傳值,如果該參數為必要,請更換BetResultModule Type`)\r\n                    } catch (e) {\r\n                        console.log(e);\r\n                    }\r\n                } else {\r\n                    this.normalResult[name] = target[name];\r\n                }\r\n            }\r\n            cc.log(this.normalResult);\r\n            SlotGameManager.instance.isResultOk = true;\r\n        }, false);\r\n    }\r\n\r\n    /**\r\n     * free回傳 game 事件接收器\r\n     * @private\r\n     */\r\n    private freeResultEvenResponse() {\r\n        EventManager.instance.serverEventListener(ServerEventType.FREE_SPIN_RESULT, (target: object) => {\r\n            for (let name of Object.keys(target)) {\r\n                if (this.freeResult[name] === undefined) {\r\n                    try {\r\n                        ErrorManager.instance.executeError(ErrorType.WebResponseErrorFW, `${name}參數未宣告:無法保存回傳值,如果該參數為必要,請更換FreeResultModule Type`);\r\n                    } catch (e) {\r\n                        console.log(e);\r\n                    }\r\n                } else {\r\n                    this.freeResult[name] = target[name];\r\n                }\r\n            }\r\n            cc.log(this.freeResult);\r\n            SlotGameManager.instance.isResultOk = true;\r\n        }, false);\r\n    }\r\n\r\n}"]}