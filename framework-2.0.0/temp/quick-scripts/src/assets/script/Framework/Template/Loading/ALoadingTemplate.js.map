{"version":3,"sources":["assets\\script\\Framework\\Template\\Loading\\ALoadingTemplate.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0DAAqD;AACrD,4DAAuD;AACvD,uEAAoE;AACpE,yDAAoD;AACpD,0GAAqG;AACrG,sEAA4D;AAErD,IAAA,OAAO,GAAI,EAAE,CAAC,UAAU,QAAjB,CAAkB;AAGhC;IAAuD,oCAAiB;IAAxE;;IA6EA,CAAC;IAzCG,sBAAI,yCAAW;aAAf;YACI,OAAO,IAAI,CAAC,YAAY,CAAA;QAC5B,CAAC;;;OAAA;IAES,iCAAM,GAAhB;QACI,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,CAAU,+BAA+B;QACnE,IAAI,CAAC,OAAO,EAAE,CAAC,CAAqB,mBAAmB;IAC3D,CAAC;IAES,gCAAK,GAAf;QACI,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAU,MAAM;QAC1C,IAAI,CAAC,eAAe,EAAE,CAAC,CAAa,QAAQ;QAC5C,IAAI,CAAC,eAAe,EAAE,CAAC,CAAa,KAAK;QACzC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAU,SAAS;IACjD,CAAC;IAGD;;OAEG;IACK,yCAAc,GAAtB;QAAA,iBAkBC;QAjBG,sBAAY,CAAC,QAAQ,CAAC,mBAAmB,CACrC,iCAAe,CAAC,UAAU,EAAE,UAAC,MAAM;;;gBAC/B,KAAiB,IAAA,KAAA,SAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA,gBAAA,4BAAE;oBAAjC,IAAI,IAAI,WAAA;oBACT,IAAI,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;wBACpC,IAAI;4BACA,sBAAY,CAAC,QAAQ,CAAC,YAAY,CAAC,4BAAS,CAAC,kBAAkB,EAAE,YAAK,IAAI,oDAAwB,CAAC,CAAA;yBACtG;wBAAC,OAAO,CAAC,EAAE;4BACR,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;yBAClB;qBACJ;yBAAM;wBACH,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;qBACvC;iBACJ;;;;;;;;;YACD,EAAE,CAAC,GAAG,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC;YACvB,qCAA2B,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YACtE,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QAC7B,CAAC,EAAE,IAAI,CAAC,CAAC;IACjB,CAAC;IA5EyB,gBAAgB;QAD7C,OAAO;OACsB,gBAAgB,CA6E7C;IAAD,uBAAC;CA7ED,AA6EC,CA7EsD,2BAAiB,GA6EvE;kBA7E6B,gBAAgB","file":"","sourceRoot":"/","sourcesContent":["import OverrideComponent from \"../OverrideComponent\";\r\nimport EventManager from \"../../Listener/EventManager\";\r\nimport {ServerEventType} from \"../../Listener/Enum/ServerEventType\";\r\nimport ErrorManager from \"../../Error/ErrorManager\";\r\nimport UserMoneyChangeNotification from \"../../Process/GameNotification/UserMoneyChangeNotification\";\r\nimport {ErrorType} from \"../../Error/Enum/ErrorManagerEnum\";\r\n\r\nconst {ccclass} = cc._decorator;\r\n\r\n@ccclass\r\nexport default abstract class ALoadingTemplate extends OverrideComponent implements ILoadTemplate {\r\n\r\n    private _canPlayGame: boolean;\r\n    protected tableInfo: ITableInfoModel;\r\n\r\n    /**\r\n     * 執行個人自定義設定\r\n     * 注意,所有override的方法,皆不要放入這裡面\r\n     */\r\n    abstract onCreat();\r\n\r\n    /**\r\n     * 載入主資源\r\n     */\r\n    abstract onLoadResources();\r\n\r\n    /**\r\n     * 載入次資源\r\n     */\r\n    abstract loadAssetBundle();\r\n\r\n    /**\r\n     * 載入外部資源\r\n     */\r\n    abstract loadExternalScript();\r\n\r\n    /**\r\n     * 更新讀取條文字動畫\r\n     */\r\n    abstract updateProgressText();\r\n\r\n    /**\r\n     * 當前scene模式,更新當前畫面是配寬高\r\n     */\r\n    abstract sceneStyle();\r\n\r\n    get canPlayGame(): boolean {\r\n        return this._canPlayGame\r\n    }\r\n\r\n    protected onLoad() {\r\n        this._canPlayGame = false;          //由 Server TableInfo Event 改變狀態\r\n        this.onCreat();                     //自訂義初始 例:拿取node...\r\n    }\r\n\r\n    protected start() {\r\n        this.tableInfoEvent();\r\n        this.sceneStyle();\r\n        this.loadExternalScript();          //外部資源\r\n        this.onLoadResources();             //載入資源方法\r\n        this.loadAssetBundle();             //次資源\r\n        this.updateProgressText();          //更新讀取條文字\r\n    }\r\n\r\n\r\n    /**\r\n     * 當Server 回傳tableInfo 資訊,將更動canPlayGame布林值,且保存tableInfo資源\r\n     */\r\n    private tableInfoEvent() {\r\n        EventManager.instance.serverEventListener(\r\n            ServerEventType.TABLE_INFO, (target) => {\r\n                for (let name of Object.keys(target)) {\r\n                    if (this.tableInfo[name] === undefined) {\r\n                        try {\r\n                            ErrorManager.instance.executeError(ErrorType.WebResponseErrorFW, `無 ${name} 參數,請更換 TableInfo Type`)\r\n                        } catch (e) {\r\n                            console.log(e);\r\n                        }\r\n                    } else {\r\n                        this.tableInfo[name] = target[name];\r\n                    }\r\n                }\r\n                cc.log(this.tableInfo);\r\n                UserMoneyChangeNotification.instance.notify(this.tableInfo.UserPoint);\r\n                this._canPlayGame = true;\r\n            }, true);\r\n    }\r\n}\r\n"]}